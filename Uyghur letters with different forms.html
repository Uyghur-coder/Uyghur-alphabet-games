<!doctype html>
<html lang="en" dir="rtl">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Uyghur Alphabet Click & Match</title>

<script src="https://cdn.tailwindcss.com"></script>
<style>
@font-face {
    font-family: 'UyghurFont';
    src: url('fonts/UKIJTuz.ttf') format('truetype');
    font-weight: normal;
    font-style: normal;
}
body { font-family: 'UyghurFont', Arial, sans-serif; -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; }

.letter-glyph { font-size: 2rem; text-align: center; }
.letter-latin { font-size: 0.9rem; text-align: center; color: #555; margin-bottom: 0.3rem; }
.slot { border: 2px dashed #ccc; border-radius: 0.5rem; width: 3rem; height: 3rem; display: flex; justify-content: center; align-items: center; cursor: pointer; margin: 0.2rem; }
.tiles-container { display: flex; flex-wrap: wrap; gap: 0.3rem; margin-top: 1rem; }
.tile { border: 2px solid #ccc; border-radius: 0.5rem; padding: 0.3rem; cursor: pointer; display: flex; flex-direction: column; align-items: center; justify-content: center; width: 3rem; height: 3rem; }
.tile.selected { border-color: #3b82f6; background-color: #dbebff; }
.letter-column { display: flex; flex-direction: column; align-items: center; margin: 0.2rem; }
.form-slot.initial { background-color: #bfdbfe; }
.form-slot.medial { background-color: #bbf7d0; }
.form-slot.final { background-color: #fef9c3; }
.prompt-row { display: flex; flex-wrap: wrap; justify-content: center; margin-bottom: 1rem; }
</style>
</head>
<body class="p-4">

<div id="root" class="max-w-6xl mx-auto"></div>

<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

<script type="text/babel">
const { useState, useEffect } = React;

// Updated Uyghur alphabet array
const LETTERS = [
  {id:"a",isolated:"ئا",initial:"ئا",medial:"ـئا",final:"ـا",latin:"a"},
  {id:"e",isolated:"ئە",initial:"ئە",medial:"ـئە",final:"ـە",latin:"e"},
  {id:"b",isolated:"ب",initial:"بـ",medial:"ـبـ",final:"ـب",latin:"b"},
  {id:"p",isolated:"پ",initial:"پـ",medial:"ـپـ",final:"ـپ",latin:"p"},
  {id:"t",isolated:"ت",initial:"تـ",medial:"ـتـ",final:"ـت",latin:"t"},
  {id:"j",isolated:"ج",initial:"جـ",medial:"ـجـ",final:"ـج",latin:"j"},
  {id:"ch",isolated:"چ",initial:"چـ",medial:"ـچـ",final:"ـچ",latin:"ch"},
  {id:"kh",isolated:"خ",initial:"خـ",medial:"ـخـ",final:"ـخ",latin:"kh"},
  {id:"d",isolated:"د",initial:"د",medial:null,final:"ـد",latin:"d"},
  {id:"r",isolated:"ر",initial:"ر",medial:null,final:"ـر",latin:"r"},
  {id:"z",isolated:"ز",initial:"ز",medial:null,final:"ـز",latin:"z"},
  {id:"zh",isolated:"ژ",initial:"ژ",medial:null,final:"ـژ",latin:"zh"},
  {id:"s",isolated:"س",initial:"سـ",medial:"ـسـ",final:"ـس",latin:"s"},
  {id:"sh",isolated:"ش",initial:"شـ",medial:"ـشـ",final:"ـش",latin:"sh"},
  {id:"gh",isolated:"غ",initial:"غـ",medial:"ـغـ",final:"ـغ",latin:"gh"},
  {id:"f",isolated:"ف",initial:"فـ",medial:"ـفـ",final:"ـف",latin:"f"},
  {id:"q",isolated:"ق",initial:"قـ",medial:"ـقـ",final:"ـق",latin:"q"},
  {id:"k",isolated:"ك",initial:"كـ",medial:"ـكـ",final:"ـك",latin:"k"},
  {id:"g",isolated:"گ",initial:"گـ",medial:"ـگـ",final:"ـگ",latin:"g"},
  {id:"ng",isolated:"ڭ",initial:"ڭـ",medial:"ـڭـ",final:"ـڭ",latin:"ng"},
  {id:"l",isolated:"ل",initial:"لـ",medial:"ـلـ",final:"ـل",latin:"l"},
  {id:"m",isolated:"م",initial:"مـ",medial:"ـمـ",final:"ـم",latin:"m"},
  {id:"n",isolated:"ن",initial:"نـ",medial:"ـنـ",final:"ـن",latin:"n"},
  {id:"h",isolated:"ھ",initial:"ھـ",medial:"ـھـ",final:"ـھ",latin:"h"},
  {id:"o",isolated:"ئو",initial:"ئو",medial:"ـئو",final:"ـو",latin:"o"},
  {id:"u",isolated:"ئۇ",initial:"ئۇ",medial:"ـئۇ",final:"ـۇ",latin:"u"},
  {id:"ö",isolated:"ئۆ",initial:"ئۆ",medial:"ـئۆ",final:"ـۆ",latin:"ö"},
  {id:"ü",isolated:"ئۈ",initial:"ئۈ",medial:"ـئۈ",final:"ـۈ",latin:"ü"},
  {id:"w",isolated:"ۋ",initial:"ۋ",medial:null,final:"ـۋ",latin:"w"},
  {id:"y",isolated:"ي",initial:"يـ",medial:"ـيـ",final:"ـي",latin:"y"},
  {id:"e2",isolated:"ئې، ې",initial:"ئېـ، ېـ",medial:"ـئېـ، ـېـ",final:"ـې",latin:"e2"},
  {id:"i",isolated:"ئى، ى",initial:"ئىـ، ىـ",medial:"ـئىـ، ـىـ",final:"ـى",latin:"i"}
];

const FORM_TYPES = ["initial","medial","final"];

function UyghurAlphabetGame() {
  const [lettersPerRound,setLettersPerRound]=useState(4);
  const [selectedLetters,setSelectedLetters]=useState([]);
  const [tiles,setTiles]=useState([]);
  const [placements,setPlacements]=useState({});
  const [selectedTile,setSelectedTile]=useState(null);

  useEffect(()=>{ startNewRound(); },[lettersPerRound]);

  function startNewRound() {
    const shuffled = LETTERS.sort(()=>0.5 - Math.random());
    const selected = shuffled.slice(0,lettersPerRound);
    setSelectedLetters(selected);
    const newTiles = selected.flatMap(letter=>FORM_TYPES.map(form=>({id:letter.id+"-"+form,letterId:letter.id,form,glyph:letter[form]}))).sort(()=>0.5 - Math.random());
    setTiles(newTiles);
    setPlacements({});
    setSelectedTile(null);
  }

  function handleTileClick(tile){ setSelectedTile(tile); }

  function handleSlotClick(letterId,form){
    if(!selectedTile) return;
    if(selectedTile.letterId===letterId && selectedTile.form===form){
      setPlacements({...placements,[letterId+"-"+form]:selectedTile.id});
    }
    setSelectedTile(null);
  }

  return (
    <div>
      <div className="flex gap-4 items-center mb-4 flex-wrap">
        <label>Letters per round:
          <select className="ml-2 p-1 border rounded" value={lettersPerRound} onChange={e=>setLettersPerRound(Number(e.target.value))}>
            {[2,4,6,8,10].map(n=> <option key={n} value={n}>{n}</option>)}
          </select>
        </label>
        <button className="px-3 py-1 bg-blue-500 text-white rounded" onClick={startNewRound}>New Round</button>
      </div>

      <div className="prompt-row">
        {selectedLetters.map(letter => (
          <div key={letter.id} className="letter-column">
            <div className="letter-glyph mb-1">{letter.isolated}</div>
            <div className="letter-latin mb-2">{letter.latin}</div>
            {FORM_TYPES.map(form => {
              const placed = placements[letter.id + "-" + form];
              const label = form.charAt(0).toUpperCase() + form.slice(1);
              return (
                <div key={form} className="mb-1 text-center">
                  <div className="text-sm text-gray-600">{label}</div>
                  <div
                    className={`form-slot slot ${form}`}
                    onClick={() => handleSlotClick(letter.id, form)}
                  >
                    {placed && <span className="letter-glyph">{letter[form]}</span>}
                  </div>
                </div>
              );
            })}
          </div>
        ))}
      </div>

      <div className="tiles-container">
        {tiles.map(tile=>{
          const placed=Object.values(placements).includes(tile.id);
          return !placed && (
            <div key={tile.id} className={`tile ${selectedTile?.id===tile.id?'selected':''}`} onClick={()=>handleTileClick(tile)}>
              <div className="letter-glyph">{tile.glyph}</div>
              {/* Show Latin name only for isolated form */}
              <div className="letter-latin">{tile.form==="initial"? "" : selectedLetters.find(l=>l.id===tile.letterId)?.latin}</div>
            </div>
          );
        })}
      </div>
    </div>
  );
}

ReactDOM.createRoot(document.getElementById('root')).render(<UyghurAlphabetGame />);
</script>
</body>
</html>
